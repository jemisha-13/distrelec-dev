SELECT DISTINCT({odr.code}),{odr.date},{dso.code} FROM {Order AS odr JOIN OrderEntry AS oe ON {oe.order}={odr.pk} JOIN OrderStatus AS ordStat ON {odr.status}={ordStat.pk} JOIN B2BUnit AS b2bun ON {odr.unit}={b2bun.pk} JOIN DistSalesOrg AS dso ON {dso.pk}={b2bun.salesOrg}} WHERE {odr.date} >= ?endDate AND {odr.erpOrderCode} IS NULL AND {ordStat.code} NOT IN ('REJECTED','PENDING_APPROVAL','PENDING_APPROVAL_FROM_MERCHANT') ORDER BY {odr.date}